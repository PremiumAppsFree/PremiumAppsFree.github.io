<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Premium Apps Free</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <style>
        :root {
            --background-dark: #121212;
            --card-dark: #1e1e1e;
            --header-dark: #1e1e1e;
            --text-primary-dark: #e0e0e0;
            --text-secondary-dark: #b0b0b0;
            --accent-green: #00c853;
            --accent-red: #d9534f;
            --accent-blue: #2979ff;
            --background-light: #f7f9fc;
            --card-light: #ffffff;
            --header-light: #ffffff;
            --text-primary-light: #1c1c1e;
            --text-secondary-light: #65676b;
            --bg-color: var(--background-dark);
            --surface-color: var(--card-dark);
            --primary-accent-color: var(--accent-green);
            --text-color-primary: var(--text-primary-dark);
            --text-color-secondary: var(--text-secondary-dark);
            --text-color-on-accent: #ffffff;
            --border-color: #333;
            --shadow-color-light: rgba(0, 0, 0, 0.2);
            --shadow-color-medium: rgba(0, 0, 0, 0.4);
            --font-body: 'Poppins', sans-serif;
        }
        
        body.light-mode {
            --bg-color: var(--background-light);
            --surface-color: var(--card-light);
            --text-color-primary: var(--text-primary-light);
            --text-color-secondary: var(--text-secondary-light);
            --border-color: #e2e8f0;
            --shadow-color-light: rgba(0, 0, 0, 0.05);
            --shadow-color-medium: rgba(0, 0, 0, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        html { scroll-behavior: smooth; }
        body { background: var(--bg-color); color: var(--text-color-primary); transition: background 0.3s, color 0.3s; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 15px; }
        
        #event-theme-html-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; overflow: hidden; }

        #preloader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99999; background: var(--background-dark); display: flex; justify-content: center; align-items: center; opacity: 1; visibility: visible; transition: opacity 0.5s ease-out, visibility 0s 0.5s; }
        body.preloader-active { overflow: hidden; }
        body:not(.preloader-active) #preloader { opacity: 0; visibility: hidden; }
        #preloader img { width: 100px; height: 100px; border-radius: 50%; animation: pulse 1.5s ease-in-out infinite; }
        @keyframes pulse { 0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(0, 200, 83, 0.7); } 70% { transform: scale(1); box-shadow: 0 0 0 20px rgba(0, 200, 83, 0); } 100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(0, 200, 83, 0); } }

        header { display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; background: var(--header-dark); box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5); position: sticky; top: 0; z-index: 100; }
        body.light-mode header { background: var(--header-light); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); }
        .logo { height: 40px; width: 40px; border-radius: 50%; object-fit: cover; flex-shrink: 0; }
        .telegram-link { display: flex; justify-content: center; align-items: center; width: 40px; height: 40px; border-radius: 50%; margin-left: 10px; background-color: #333; transition: background-color 0.3s; flex-shrink: 0; }
        body.light-mode .telegram-link { background-color: #f0f2f5; }
        .telegram-link img { height: 22px; }
        .site-title { flex-grow: 1; text-align: center; font-size: 18px; font-weight: 600; margin: 0 10px; white-space: nowrap; opacity: 1; transform: scale(1); transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1); }
        header.search-active .site-title { opacity: 0; transform: scale(0.9); width: 0; margin: 0; }
        .search-container { position: relative; display: flex; align-items: center; width: 40px; height: 40px; background-color: var(--accent-green); border-radius: 25px; transition: width 0.4s cubic-bezier(0.23, 1, 0.32, 1), background-color 0.4s; flex-shrink: 0; }
        header.search-active .search-container { width: 250px; background-color: #333; }
        body.light-mode header.search-active .search-container { background-color: #e4e6eb; }
        .search { width: 100%; height: 100%; border: none; background: transparent; color: white; padding: 0 45px 0 20px; font-size: 14px; outline: none; opacity: 0; transition: opacity 0.3s ease 0.1s; }
        header.search-active .search { opacity: 1; }
        body.light-mode .search { color: #050505; }
        .search-icon { position: absolute; right: 0; top: 0; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; border-radius: 50%; }
        .search-icon svg { width: 20px; height: 20px; stroke: #ffffff; fill: none; stroke-width: 2.5; stroke-linecap: round; stroke-linejoin: round; }
        header.search-active .search-icon svg { stroke: var(--text-secondary-dark); }
        body.light-mode .search-icon svg { stroke: var(--text-secondary-dark); }
        .search-icon .search-circle, .search-icon .search-line1, .search-icon .close-line1, .search-icon .close-line2 { transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1); }
        .search-icon .close-line1, .search-icon .close-line2 { opacity: 0; stroke-dasharray: 20; stroke-dashoffset: 20; }
        header.search-active .search-icon .search-circle { transform-origin: center; transform: scale(0.5); opacity: 0; }
        header.search-active .search-icon .search-line1 { transform: rotate(45deg); opacity: 0; }
        header.search-active .search-icon .close-line1, header.search-active .search-icon .close-line2 { opacity: 1; stroke-dashoffset: 0; }

        .section-header { display: flex; align-items: center; gap: 12px; margin: 28px 0 16px 0; }
        .section-icon { color: var(--primary-accent-color); font-size: 28px; }
        .section-title { font-size: 20px; font-weight: 600; color: var(--text-color-primary); }
        
        /* --- Hot Items Carousel (New) --- */
        .popular-carousel {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding: 10px 5px 20px 5px;
            scroll-snap-type: x mandatory;
            scroll-padding-left: 15px;
            scrollbar-width: none;
            -ms-overflow-style: none;
            margin-bottom: 20px;
        }
        .popular-carousel::-webkit-scrollbar { display: none; }
        .hot-card-item {
            flex: 0 0 280px;
            position: relative;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            scroll-snap-align: start;
            margin-bottom: 20px;
        }
        .hot-card-item:hover .popular-card-base {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px var(--shadow-color-medium);
        }
        .popular-card-base {
            width: 100%;
            height: 200px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            background: var(--surface-color);
            box-shadow: 0 10px 25px var(--shadow-color-light);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .popular-card-abstract-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            border-radius: inherit; overflow: hidden; z-index: 0;
        }
        .popular-card-abstract-bg img, .popular-card-abstract-bg svg { 
            width: 100%; height: 100%; display: block; object-fit: cover; 
        }
        .android-badge {
            position: absolute; top: 15px; right: 15px;
            background: white;
            padding: 4px 8px; border-radius: 16px;
            display: flex; align-items: center; justify-content: center;
            font-size: 12px; font-weight: 700;
            color: var(--text-primary-light);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 15; gap: 4px;
        }
        body[dir="rtl"] .android-badge { right: auto; left: 15px; }
        .android-badge .material-icons { font-size: 16px; color: #a4c639; line-height: 1; }
        .popular-app-logo-wrapper {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 100px; height: 100px;
            border-radius: 25px; overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            z-index: 10;
            background-color: white; border: 3px solid white;
            display: flex; align-items: center; justify-content: center;
        }
        .popular-app-logo {
            width: 100%; height: 100%;
            object-fit: contain; border-radius: inherit;
        }
        .popular-card-app-name {
            font-size: 16px; font-weight: 600;
            color: var(--text-color-primary);
            margin-top: 15px; text-align: center;
            white-space: nowrap; overflow: hidden;
            text-overflow: ellipsis; max-width: 100%;
            padding: 0 5px;
        }

        .category-section { margin-bottom: 20px; }
        .category-item-carousel { display: flex; gap: 16px; overflow-x: auto; padding: 10px 5px 20px 5px; scrollbar-width: none; -ms-overflow-style: none; }
        .category-item-carousel::-webkit-scrollbar { display: none; }
        .category-item-carousel .item-card { flex-shrink: 0; width: 160px; }

        #hearts-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; pointer-events: none; }
        @keyframes float-up { 0% { bottom: -100px; opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { bottom: 100vh; opacity: 0; } }
        .heart { position: absolute; bottom: -100px; animation: float-up 10s linear infinite; }
        .heart svg { width: var(--size); height: var(--size); opacity: 0.6; }
        body.light-mode .heart svg { fill: rgba(222, 49, 99, 0.4); } 
        body:not(.light-mode) .heart svg { fill: rgba(255, 105, 180, 0.4); }

        .item-grid { display: grid; gap: 16px; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); min-height: 200px;}
        .item-card { background: var(--surface-color); border-radius: 16px; box-shadow: 0 2px 8px var(--shadow-color-light); transition: transform 0.3s ease, box-shadow 0.3s ease; text-align: center; padding: 15px; position: relative; cursor: pointer; }
        .item-card:hover { transform: translateY(-5px); box-shadow: 0 6px 15px var(--shadow-color-medium); }
        .item-card-icon-container { width: 70px; height: 70px; margin: 0 auto 12px auto; border-radius: 18px; overflow: hidden; background-color: #333;}
        .item-card-icon { width: 100%; height: 100%; object-fit: cover; }
        .item-card-title { font-size: 15px; font-weight: 600; color: var(--text-color-primary); margin-bottom: 2px; line-height: 1.3; word-break: break-word; }
        .item-card-info { display: flex; justify-content: space-between; font-size: 11px; color: var(--text-color-secondary); opacity: 0.8; border-top: 1px solid var(--border-color); padding-top: 8px; margin-top: 8px; }
        .loading-message { text-align: center; color: var(--text-color-secondary); font-style: italic; margin: 40px auto; width: 100%; font-size: 16px; grid-column: 1 / -1; }

        .new-tag {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--accent-red);
            color: white;
            font-size: 10px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 4px;
            z-index: 1;
        }
        body[dir="rtl"] .new-tag {
            left: auto;
            right: 10px;
        }
        .new-tag::before {
            content: '';
            display: block;
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            animation: pulse-dot 1.5s infinite;
        }
        @keyframes pulse-dot {
            0%, 100% { opacity: 0.7; transform: scale(0.9); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        #sectionDetail { display: none; padding: 20px 0; max-width: 700px; margin: 0 auto; }
        #sectionDetail.active { display: block; animation: slideInUp 0.5s ease-out forwards; }
        @keyframes slideInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        .hidden { display: none !important; }
        .detail-header { display: flex; align-items: center; margin-bottom: 25px; }
        .btn-back { background: none; border: none; color: var(--text-color-primary); font-size: 28px; cursor: pointer; margin-right: 15px; }
        .detail-title { font-size: 22px; font-weight: 600; color: var(--text-color-primary); }
        .detail-card { background: var(--surface-color); padding: 20px; border-radius: 16px; display: flex; gap: 20px; align-items: center; margin-bottom: 25px; }
        #detailAppImage { width: 80px; height: 80px; border-radius: 20px; object-fit: cover; flex-shrink: 0; background-color: #333; }
        #detailAppName { font-size: 20px; font-weight: 600; }
        #detailAppInfo { font-size: 14px; color: var(--text-color-secondary); margin: 2px 0 6px 0; }
        
        .detail-actions { display: flex; flex-direction: column; gap: 12px; margin-top: 25px; }
        .btn { padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; border: none; transition: all 0.2s ease; font-size: 15px; display: flex; align-items: center; justify-content: center; gap: 10px; text-decoration: none; width: 100%; }
        .btn-primary { background: var(--primary-accent-color); color: var(--text-color-on-accent); }
        .btn-secondary { background: var(--surface-color); color: var(--text-color-primary); box-shadow: 0 2px 5px var(--shadow-color-light); }
        body.light-mode .btn-secondary { background: #eef2f7; }
        .btn-icon-img { height: 22px; width: 22px; object-fit: contain; }
        
        .detail-section-content { margin-bottom: 25px; background: var(--surface-color); padding: 20px; border-radius: 12px; }
        .detail-section-content .subtitle { color: var(--text-color-primary); margin-bottom: 15px; font-size: 18px; font-weight: 600; }
        
        #detailAppDescContainer ul { list-style: none; padding-left: 0; }
        #detailAppDescContainer li { display: flex; align-items: flex-start; margin-bottom: 12px; font-size: 15px; color: var(--text-color-secondary); line-height: 1.6; }
        #detailAppDescContainer li .material-icons { margin-right: 12px; font-size: 22px; color: var(--primary-accent-color); }
        
        .screenshot-gallery { overflow-x: auto; display: flex; gap: 12px; padding: 10px 0; scrollbar-width: none; }
        .screenshot-gallery::-webkit-scrollbar { display: none; }
        .screenshot-img { height: 250px; width: auto; border-radius: 12px; object-fit: cover; cursor: pointer; border: 1px solid var(--border-color); transition: transform 0.2s ease; }
        .screenshot-img:hover { transform: scale(1.03); }
        
        .lightbox-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); z-index: 4000; display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: opacity 0.3s ease; backdrop-filter: blur(8px); }
        .lightbox-overlay.active { opacity: 1; visibility: visible; }
        .lightbox-content { position: relative; max-width: 95vw; max-height: 90vh; }
        .lightbox-image { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 8px; }
        .lightbox-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(255, 255, 255, 0.1); color: white; border: none; border-radius: 50%; width: 44px; height: 44px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 28px; transition: background-color 0.2s; }
        .lightbox-prev { left: -60px; }
        .lightbox-next { right: -60px; }
        .lightbox-close { position: absolute; top: -45px; right: -10px; background: none; border: none; color: white; font-size: 40px; cursor: pointer; }
        
        .animated-text { background-image: linear-gradient(90deg, #ffffff, #f0ff00, #00ffea, #ff00f2, #ffffff); background-size: 250% auto; -webkit-background-clip: text; background-clip: text; color: transparent; animation: animated-text-gradient 3s linear infinite; font-weight: 700; }
        @keyframes animated-text-gradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); justify-content: center; align-items: center; z-index: 12000; }
        .modal-content { background: #222; padding: 20px; border-radius: 10px; text-align: left; width: 90%; max-width: 500px; }
        body.light-mode .modal-content { background: var(--card-light); }
        .modal-content h2 { margin-bottom: 15px; text-align: center;}
        .changelog-content h3 { color: var(--accent-green); margin-top: 20px; margin-bottom: 5px; }
        .changelog-content ul { list-style-type: disc; padding-left: 20px; }
        .changelog-content li { margin-bottom: 8px; }

        #settings-modal { position: fixed; top: 0; right: -320px; width: 300px; height: 100%; background: var(--card-dark); z-index: 11000; box-shadow: -5px 0 15px rgba(0, 0, 0, 0.5); transition: right 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94); padding: 20px; overflow-y: auto; }
        #settings-modal.open { right: 0; }
        body.light-mode #settings-modal { background: var(--card-light); }
        .setting-option { margin-bottom: 25px; opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease-out, transform 0.5s ease-out; }
        .setting-option.is-visible { opacity: 1; transform: translateY(0); }
        #settings-modal .settings-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        #settings-modal h2 { font-size: 24px; }
        #settings-modal .close-btn { font-size: 30px; cursor: pointer; }
        .setting-option label, .setting-option .label-switch-container > span { display: block; margin-bottom: 10px; font-weight: 600; display: flex; align-items: center; gap: 8px;}
        .label-switch-container { display: flex; justify-content: space-between; align-items: center; }
        .theme-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
        .theme-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #333; transition: .4s; border-radius: 26px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked+.slider { background-color: var(--accent-green); }
        input:checked+.slider:before { transform: translateX(24px); }
        #sort-select, #language-select, #items-per-page-select { width: 100%; padding: 10px; background: #333; color: white; border: 1px solid #555; border-radius: 5px; font-size: 14px; }
        body.light-mode #sort-select, body.light-mode #language-select, body.light-mode #items-per-page-select { background: #e4e6eb; color: #050505; }
        #sort-select:disabled { background: #2a2a2a; color: #777; cursor: not-allowed; }
        .sort-note { font-size:12px; color: var(--text-secondary-dark); margin-top: 5px; }
        .category-buttons { display: flex; flex-wrap: wrap; gap: 8px; }
        .category-buttons button { background: #333; border: 1px solid #555; padding: 6px 12px; font-size: 13px; color: white; border-radius: 5px; cursor: pointer;}
        .category-buttons button.active { background: var(--accent-green); border-color: var(--accent-green); }
        body.light-mode .category-buttons button { background: #e4e6eb; color: #1c1c1e; border-color: #ced0d4;}
        body.light-mode .category-buttons button.active { background: var(--accent-green); color: white; }
        .simple-button { width: 100%; padding: 10px; background: var(--accent-blue); border: none; color: white; border-radius: 5px; font-weight: 600; cursor: pointer; }
        #reset-settings-btn { background: var(--accent-red); }

        #floating-settings-btn { position: fixed; bottom: 20px; right: 20px; background: var(--accent-green); color: white; border-radius: 50%; width: 55px; height: 55px; display: flex; justify-content: center; align-items: center; cursor: pointer; z-index: 9999; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4); -webkit-tap-highlight-color: transparent; outline: none; }
        #floating-settings-btn svg { width: 28px; height: 28px; fill: white; transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        #floating-settings-btn.rotate svg { transform: rotate(360deg); }
        
        #popup-form { display: none; position: fixed; bottom: 90px; right: 20px; background: #1c1c1c; border-radius: 10px; padding: 20px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5); z-index: 9998; width: 90%; max-width: 300px; flex-direction: column; }
        #popup-form input, #popup-form textarea { background: #333; border: 1px solid #444; padding: 10px; border-radius: 5px; margin-bottom: 10px; color: white; width: 100%; }
        body.light-mode #popup-form input, body.light-mode #popup-form textarea { background: #e4e6eb; color: #050505; }
        
        .not-found-container { grid-column: 1 / -1; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px 20px; text-align: center; }

        body[dir="rtl"] { direction: rtl; }
        body[dir="rtl"] .telegram-link { margin-left: 0; margin-right: 10px; }
        body[dir="rtl"] .search-icon { left: 0; right: auto; }
        body[dir="rtl"] .search { padding: 0 20px 0 45px; }
        body[dir="rtl"] .btn-back { margin-right: 0; margin-left: 15px; }
        body[dir="rtl"] #detailAppDescContainer li .material-icons { margin-right: 0; margin-left: 12px; }
        body[dir="rtl"] .label-switch-container { flex-direction: row-reverse; }
        body[dir="rtl"] .setting-option label, body[dir="rtl"] .setting-option .label-switch-container > span { gap: 8px; }
        body[dir="rtl"] .settings-header { flex-direction: row-reverse; }
        body[dir="rtl"] #settings-modal { right: auto; left: -320px; transition: left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94); box-shadow: 5px 0 15px rgba(0,0,0,0.5); }
        body[dir="rtl"] #settings-modal.open { left: 0; }
        body[dir="rtl"] #floating-settings-btn { right: auto; left: 20px; }

        .item-card, .hot-card-item { -webkit-tap-highlight-color: transparent; tap-highlight-color: transparent; opacity: 0; transform: scale(0.95); transition: opacity 0.5s ease-out, transform 0.5s ease-out; }
        .item-card.is-visible, .hot-card-item.is-visible { opacity: 1; transform: scale(1); }
        @keyframes scale-up-fade-in { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .is-visible { animation: scale-up-fade-in 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }

        @media (max-width: 768px) {
            .detail-card { flex-direction: column; text-align: center; }
            .lightbox-prev { left: 5px; }
            .lightbox-next { right: 5px; }
            body[dir="rtl"] .lightbox-prev { right: 5px; left: auto; }
            body[dir="rtl"] .lightbox-next { left: 5px; right: auto; }
            .lightbox-close { top: 10px; right: 10px; font-size: 32px; background: rgba(0, 0, 0, 0.3); border-radius: 50%; width: 40px; height: 40px; }
        }
        @media (max-width: 480px) {
            .category-item-carousel .item-card { width: 140px; }
            .hot-card-item { flex: 0 0 240px; }
            .popular-card-base { height: 180px; }
            .popular-app-logo-wrapper { width: 80px; height: 80px; border-radius: 20px; border-width: 2px; }
            .popular-card-app-name { font-size: 14px; }
        }
    </style>
</head>
<body class="preloader-active">
    
    <div id="event-theme-html-container"></div>
    
    <div id="hearts-container"></div>
    <div id="preloader"><img src="https://i.ibb.co/MyjL8DZk/IMG-20250502-151238-214.jpg" alt="Loading..."></div>
    
    <header>
        <img src="https://i.ibb.co/MyjL8DZk/IMG-20250502-151238-214.jpg" alt="Logo" class="logo">
        <h2 class="site-title animated-text">Premium App Free</h2>
        <div class="search-container">
            <input type="text" class="search" data-translate-key="searchPlaceholder" placeholder="Search apps...">
            <div class="search-icon">
                <svg viewBox="0 0 24 24"><circle class="search-circle" cx="11" cy="11" r="8"></circle><line class="search-line1" x1="21" y1="21" x2="16.65" y2="16.65"></line><line class="close-line1" x1="8" y1="8" x2="14" y2="14"></line><line class="close-line2" x1="14" y1="8" x2="8" y2="14"></line></svg>
            </div>
        </div>
        <a href="https://t.me/apps_pro_freee" class="telegram-link" target="_blank"><img src="https://i.ibb.co/844sJLWV/800px-Telegram-2019-Logo-svg.png" alt="Telegram"></a>
    </header>
    
    <div id="mainContentWrapper">
        <div class="container">
            <!-- Hot Items Section -->
            <div id="hotItemsSection" class="hidden">
                 <div class="section-header">
                    <span class="material-icons section-icon" style="color: #ff3d71;">whatshot</span>
                    <h2 class="section-title">Hot Items</h2>
                </div>
                <div id="hotItemsCarousel" class="popular-carousel">
                    <!-- Hot items will be injected by JS -->
                </div>
            </div>

            <div id="categoryCarouselsContainer">
                <p class="loading-message" data-translate-key="loadingApps">Loading apps...</p>
            </div>
            <div id="latestSection" class="section active hidden">
                 <div class="section-header">
                    <h2 id="latest-section-title" class="section-title" data-translate-key="searchResults">Search Results</h2>
                </div>
                <div id="latestList" class="item-grid">
                    <!-- Search results appear here -->
                </div>
            </div>
        </div>
    </div>

    <div id="sectionDetail">
        <div class="container">
            <div class="detail-header">
                <button class="btn-back"><span class="material-icons">arrow_back</span></button>
                <h2 class="detail-title">Details</h2>
            </div>
            <div class="detail-card">
                <img id="detailAppImage" src="" alt="Item Icon">
                <div class="detail-info">
                    <h3 id="detailAppName">Item Name</h3>
                    <p id="detailAppInfo">Version: 1.0 | Size: 0 MB</p>
                </div>
            </div>
            
            <div class="detail-actions">
                <a href="#" target="_blank" id="detailAppDownloadLink" class="btn btn-primary">
                    <span class="material-icons">download</span><span>Download</span>
                </a>
                <a href="https://player.vimeo.com/video/1080856907" target="_blank" class="btn btn-secondary">
                    <span class="material-icons">play_circle_outline</span><span>How to Download</span>
                </a>
                <a href="#" target="_blank" id="detailAppPlayStoreLink" class="btn btn-secondary hidden">
                    <img src="https://i.postimg.cc/Wbw73V2y/Picsart-25-07-13-10-48-29-353.png" class="btn-icon-img" alt="Google Play Store Icon">
                    <span>View on Play Store</span>
                </a>
            </div>

            <div id="screenshotSection" class="detail-section-content hidden">
                <h4 class="subtitle">Screenshots</h4>
                <div id="screenshotGallery" class="screenshot-gallery"></div>
            </div>
            <div class="detail-section-content">
                <h4 class="subtitle">About this item</h4>
                <div id="detailAppDescContainer">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    
    <div id="lightboxOverlay" class="lightbox-overlay">
        <div class="lightbox-content">
            <img id="lightboxImage" class="lightbox-image" src="" alt="Fullscreen Screenshot">
            <button id="lightboxClose" class="lightbox-close">&times;</button>
            <button id="lightboxPrev" class="lightbox-nav lightbox-prev material-icons">chevron_left</button>
            <button id="lightboxNext" class="lightbox-nav lightbox-next material-icons">chevron_right</button>
        </div>
    </div>
    
    <div id="settings-modal">
        <div class="settings-header">
            <h2 data-translate-key="settingsTitle">Settings</h2>
            <span class="close-btn" id="close-settings-btn">√ó</span>
        </div>
        <div class="setting-option"><div class="label-switch-container"><span data-translate-key="themeLabel"><i class="material-icons">brightness_6</i> Day/Night Mode</span><label class="theme-switch"><input type="checkbox" id="theme-toggle"><span class="slider"></span></label></div></div>
        
        <div class="setting-option"><label for="language-select" data-translate-key="languageLabel"><i class="material-icons">language</i> Choose Language</label>
            <select id="language-select">
                <option value="en">English</option>
                <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (Bengali)</option>
                <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</option>
                <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (Arabic)</option>
                <option value="ur">ÿßÿ±ÿØŸà (Urdu)</option>
                <option value="fa">ŸÅÿßÿ±ÿ≥€å (Persian)</option>
                <option value="pt">Portugu√™s (Portuguese)</option>
                <option value="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç (Malayalam)</option>
                <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)</option>
                <option value="as">‡¶Ö‡¶∏‡¶Æ‡ßÄ‡¶Ø‡¶º‡¶æ (Assamese)</option>
            </select>
        </div>

        <div class="setting-option"><label for="items-per-page-select" data-translate-key="itemsPerPageLabel"><i class="material-icons">view_list</i> Apps Per Page</label><select id="items-per-page-select"><option value="12">12</option><option value="24">24</option><option value="36">36</option></select></div>
        <div class="setting-option"><div class="label-switch-container"><span data-translate-key="infiniteScrollLabel"><i class="material-icons">swipe_down</i> Infinite Scroll</span><label class="theme-switch"><input type="checkbox" id="infinite-scroll-toggle" checked><span class="slider"></span></label></div></div>
        <div class="setting-option"><label for="sort-select" data-translate-key="sortByLabel"><i class="material-icons">sort_by_alpha</i> Sort Results By</label><select id="sort-select"><option value="default">Default</option><option value="name-az">Name (A-Z)</option><option value="name-za">Name (Z-A)</option></select><p class="sort-note" data-translate-key="sortNote">Sorting is only active for search/filter results.</p></div>
        <div class="setting-option"><label data-translate-key="filterByCategoryLabel"><i class="material-icons">filter_list</i> Filter by Category</label><div class="category-buttons" id="category-filter-buttons"></div><button id="clear-filters-btn" class="simple-button" data-translate-key="clearFiltersBtn" style="margin-top: 10px;"><span>Clear Filters</span></button></div>
        <div class="setting-option"><label data-translate-key="otherLabel"><i class="material-icons">more_horiz</i> Other Options</label><button id="contact-owner-btn" class="simple-button" style="margin-bottom: 10px;"><span data-translate-key="submitProblemBtn">Submit a Problem</span></button><button id="changelog-btn" class="simple-button"><span>Changelog</span></button></div>
        <div class="setting-option"><button id="reset-settings-btn" class="simple-button" data-translate-key="resetSettingsBtn"><span><i class="material-icons" style="font-size: 16px; margin-right: 5px;">delete_sweep</i> Reset All Settings</span></button></div>
    </div>
    
    <div class="modal" id="popup"><div class="modal-content" id="popup-content"></div></div>
    <div id="floating-settings-btn"><svg viewBox="0 0 24 24"><path fill="white" d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.22C8.66,5.46,8.13,5.78,7.63,6.16L5.24,5.2c-0.22-0.08-0.47,0-0.59,0.22L2.73,8.74 c-0.11,0.2-0.06,0.47,0.12,0.61l2.03,1.58C4.82,11.36,4.8,11.68,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.41 c0.04,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.43,0.17,0.47,0.41l0.36-2.41c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0-0.59-0.22l1.92-3.32c0.11-0.2,0.06-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z" /></svg></div>
    <div id="popup-form"><input type="text" id="userName" placeholder="Your Name"><textarea id="userProblem" rows="4" placeholder="Submit your problem..."></textarea><button id="send-to-owner-btn"><span class="animated-text">Send to Owner</span></button></div>

    <footer style="background-color: #111; color: white; text-align: center; padding: 20px 10px; font-family: sans-serif;">
        <p style="margin: 5px;">PremiumAppsFree Pvt Ltd</p>
        <p style="margin: 5px;">Copyright ¬©Ô∏è clam 2026</p>
        <p style="margin: 5px;">We respect copyright ‚Äî no copyright content intended</p>
        <p style="margin: 5px;"><a href="https://t.me/+D4b-FK6OG6swOTI1" target="_blank" style="color: #00acee; text-decoration: none;">Join our Telegram Channel</a></p>
        <p style="margin-top: 20px; animation: fadeInFooter 2s infinite alternate;"><a href="#" target="_blank" style="color: #00ffcc; text-decoration: none; font-weight: bold;">Developer By ìÉ†Ôº≤ùî∏ùêâìÉ†</a></p>
        <style> @keyframes fadeInFooter { from { opacity: 0.4; } to { opacity: 1; } } </style>
    </footer>

<script>
    const translations = {
        en: { settingsTitle: "Settings", themeLabel: "<i class='material-icons'>brightness_6</i> Day/Night Mode", languageLabel: "<i class='material-icons'>language</i> Choose Language", itemsPerPageLabel: "<i class='material-icons'>view_list</i> Apps Per Page", infiniteScrollLabel: "<i class='material-icons'>swipe_down</i> Infinite Scroll", sortByLabel: "<i class='material-icons'>sort_by_alpha</i> Sort Results By", sortNote: "Sorting is only active for search/filter results.", filterByCategoryLabel: "<i class='material-icons'>filter_list</i> Filter by Category", otherLabel: "<i class='material-icons'>more_horiz</i> Other Options", submitProblemBtn: "Submit a Problem", resetSettingsBtn: "<span><i class='material-icons' style='font-size: 16px; margin-right: 5px;'>delete_sweep</i> Reset All Settings</span>", searchPlaceholder: "Search apps...", loadingApps: "Loading apps...", searchResults: "Search Results", notFoundTitle: "No Results Found", clearFiltersBtn: "Clear Filters", changelogTitle: "Changelog", categoryAll: "All" },
        bn: { settingsTitle: "‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏", themeLabel: "<i class='material-icons'>brightness_6</i> ‡¶¶‡¶ø‡¶®/‡¶∞‡¶æ‡¶§ ‡¶Æ‡ßã‡¶°", languageLabel: "<i class='material-icons'>language</i> ‡¶≠‡¶æ‡¶∑‡¶æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®", itemsPerPageLabel: "<i class='material-icons'>view_list</i> ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶™‡ßá‡¶ú‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™", infiniteScrollLabel: "<i class='material-icons'>swipe_down</i> ‡¶Ö‡¶∏‡ßÄ‡¶Æ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡ßã‡¶≤", sortByLabel: "<i class='material-icons'>sort_by_alpha</i> ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶∏‡¶æ‡¶ú‡¶æ‡¶®", sortNote: "‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶¨‡¶æ ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∏‡¶æ‡¶ú‡¶æ‡¶®‡ßã ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨‡•§", filterByCategoryLabel: "<i class='material-icons'>filter_list</i> ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶ó‡¶∞‡¶ø ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞", otherLabel: "<i class='material-icons'>more_horiz</i> ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡¶∂‡¶®", submitProblemBtn: "‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®", resetSettingsBtn: "<span><i class='material-icons' style='font-size: 16px; margin-right: 5px;'>delete_sweep</i> ‡¶∏‡¶¨ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</span>", searchPlaceholder: "‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡¶∏ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®...", loadingApps: "‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡¶∏ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", searchResults: "‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶®‡ßá‡¶∞ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤", notFoundTitle: "‡¶ï‡ßã‡¶®‡ßã ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø", clearFiltersBtn: "‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®", changelogTitle: "‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ", categoryAll: "‡¶∏‡¶¨" },
    };

    let allAppsData = [];
    let currentDetailApp = null, currentScreenshotIndex = 0;
    let searchDebounceTimeout, settingsObserver;
    let currentLanguage = 'en';
    const NEW_DURATION_MS = 3 * 24 * 60 * 60 * 1000; // Apps added within 3 days are "new"

    const firebaseConfig = { apiKey: "AIzaSyDklPQcjXfwKIaOoBHQiJbAIq4PrqR2cxs", authDomain: "premiumappsfree-ac666.firebaseapp.com", databaseURL: "https://premiumappsfree-ac666-default-rtdb.firebaseio.com", projectId: "premiumappsfree-ac666", storageBucket: "premiumappsfree-ac666.appspot.com", messagingSenderId: "406207439410", appId: "1:406207439410:web:b98131982dd86d13de122b" };
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const appsRef = database.ref('apps');
    
    const eventConfigRef = database.ref('eventConfig');
    const themesRef = database.ref('themes');

    const getEl = id => document.getElementById(id);
    const queryEl = selector => document.querySelector(selector);
    const queryAll = selector => document.querySelectorAll(selector);

    document.addEventListener('DOMContentLoaded', () => {
        loadInitialSettings();
        setupEventListeners();
        startFloatingHearts();
        setupSettingsAnimation();
        loadAllData();
        setupScrollAnimations();
        initializeThemeEngine();
    });

    function applyEventTheme(theme) {
        removeEventTheme(); 
        if (theme.css) { const styleEl = document.createElement('style'); styleEl.id = 'event-theme-style'; styleEl.innerHTML = theme.css; document.head.appendChild(styleEl); }
        if (theme.html) { const htmlContainer = getEl('event-theme-html-container'); if (htmlContainer) { htmlContainer.innerHTML = theme.html; } }
    }
    function removeEventTheme() {
        const styleEl = getEl('event-theme-style'); if (styleEl) styleEl.remove();
        const htmlContainer = getEl('event-theme-html-container'); if (htmlContainer) htmlContainer.innerHTML = '';
    }
    function initializeThemeEngine() {
        eventConfigRef.on('value', (snapshot) => {
            const config = snapshot.val() || { activeThemeId: 'none', mode: 'live' };
            const isTestModePreview = new URLSearchParams(window.location.search).get('test_theme') === 'true';
            removeEventTheme();
            const shouldShowTheme = (config.mode === 'live') || (config.mode === 'test' && isTestModePreview);
            if (config.activeThemeId && config.activeThemeId !== 'none' && shouldShowTheme) {
                themesRef.child(config.activeThemeId).once('value', themeSnapshot => {
                    if (themeSnapshot.exists()) applyEventTheme(themeSnapshot.val());
                });
            }
        });
    }

    function loadInitialSettings() {
        const savedTheme = localStorage.getItem('theme') || 'light';
        getEl('theme-toggle').checked = savedTheme === 'light';
        document.body.classList.toggle('light-mode', savedTheme === 'light');
        const savedLang = localStorage.getItem('language') || 'en';
        getEl('language-select').value = savedLang;
        updateAllUIText(savedLang);
        getEl('items-per-page-select').value = localStorage.getItem('itemsPerPage') || '24';
        getEl('infinite-scroll-toggle').checked = localStorage.getItem('infiniteScroll') !== 'false';
        getEl('sort-select').value = 'default';
    }

    async function loadAllData() {
        try {
            const allAppsSnapshot = await appsRef.once('value');
            if (allAppsSnapshot.exists()) {
                allAppsData = Object.values(allAppsSnapshot.val());
                allAppsData.sort((a,b) => (b.addedTimestamp || 0) - (a.addedTimestamp || 0));
                handleFilterOrSearch();
                generateCategoryButtons();
            } else {
                getEl('categoryCarouselsContainer').innerHTML = `<p class="loading-message">No apps found.</p>`;
            }
        } catch(e) { 
            console.error("Data load failed:", e); 
            getEl('categoryCarouselsContainer').innerHTML = `<p class="loading-message">Failed to load apps. Please check console.</p>`;
        }
        finally { document.body.classList.remove('preloader-active'); }
    }
    
    function handleFilterOrSearch() {
        const searchTerm = queryEl('.search').value.toLowerCase();
        const currentCategory = localStorage.getItem('category') || 'all';
        const isFiltering = searchTerm || currentCategory !== 'all';
        getEl('sort-select').disabled = !isFiltering;
        const hotItemsSection = getEl('hotItemsSection');
        const carouselsContainer = getEl('categoryCarouselsContainer');
        const latestGridSection = getEl('latestSection');
        if (isFiltering) {
            hotItemsSection.classList.add('hidden');
            carouselsContainer.classList.add('hidden');
            latestGridSection.classList.remove('hidden');
            applyFiltersAndDisplay();
        } else {
            getEl('sort-select').value = 'default';
            latestGridSection.classList.add('hidden');
            hotItemsSection.classList.remove('hidden');
            carouselsContainer.classList.remove('hidden');
            renderHotItems(allAppsData);
            renderCategoryCarousels(allAppsData);
        }
    }

    function renderHotItems(apps) {
        const container = getEl('hotItemsCarousel');
        const section = getEl('hotItemsSection');
        container.innerHTML = '';
        const hotApps = apps.filter(app => app.isHot);

        if (hotApps.length === 0) {
            section.classList.add('hidden');
            return;
        }
        section.classList.remove('hidden');

        hotApps.forEach(app => {
            const androidBadgeHTML = app.androidVersion ? `
                <div class="android-badge">
                    <span class="material-icons">android</span> ${escapeHTML(app.androidVersion)}+
                </div>` : '';
            
            let backgroundHTML = '';
            if (app.hotItemBackgroundUrl) {
                backgroundHTML = `<img src="${escapeHTML(app.hotItemBackgroundUrl)}" alt="Hot Item Background">`;
            } else {
                backgroundHTML = `<svg viewBox="0 0 280 200" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 80C50 20, 150 0, 200 50L200 0L0 0L0 80Z" fill="#78B9F5" opacity="0.6"/><path d="M120 0C170 20, 250 80, 280 120L280 0Z" fill="#FDD835" opacity="0.7"/><path d="M0 120C50 180, 150 200, 200 150L200 200L0 200L0 120Z" fill="#F48FB1" opacity="0.6"/><path d="M100 200C150 180, 250 120, 280 80L280 200Z" fill="#81C784" opacity="0.7"/></svg>`;
            }

            const cardHTML = `
                <div class="hot-card-item" data-app-id="${app.id}">
                    <div class="popular-card-base">
                        <div class="popular-card-abstract-bg">
                            ${backgroundHTML}
                        </div>
                        ${androidBadgeHTML}
                        <div class="popular-app-logo-wrapper">
                            <img src="${escapeHTML(app.img)}" class="popular-app-logo" alt="${escapeHTML(app.name)} Logo" onerror="this.src='https://i.ibb.co/MyjL8DZk/IMG-20250502-151238-214.jpg'">
                        </div>
                    </div>
                    <h3 class="popular-card-app-name">${escapeHTML(app.name)}</h3>
                </div>`;
            container.insertAdjacentHTML('beforeend', cardHTML);
        });
    }

    function renderCategoryCarousels(apps) {
        const container = getEl('categoryCarouselsContainer');
        container.innerHTML = '';
        const categoryMap = apps.reduce((acc, app) => {
            const cat = app.category || 'Other';
            if (!acc[cat]) acc[cat] = [];
            acc[cat].push(app);
            return acc;
        }, {});
        Object.entries(categoryMap).sort(([a], [b]) => a.localeCompare(b)).forEach(([category, appsInCategory]) => {
            container.insertAdjacentHTML('beforeend', `<div class="category-section"><div class="section-header"><h2 class="section-title">${escapeHTML(category)}</h2></div><div class="category-item-carousel">${appsInCategory.map(app => createAppCardHTML(app)).join('')}</div></div>`);
        });
    }

    function applyFiltersAndDisplay() {
        let filteredApps = [...allAppsData];
        const searchTerm = queryEl('.search').value.toLowerCase();
        const currentCategory = localStorage.getItem('category') || 'all';
        if (currentCategory !== 'all') { filteredApps = filteredApps.filter(app => app.category === currentCategory); }
        if (searchTerm) { filteredApps = filteredApps.filter(app => app.name.toLowerCase().includes(searchTerm)); }
        switch (getEl('sort-select').value) {
            case 'name-az': filteredApps.sort((a, b) => a.name.localeCompare(b.name)); break;
            case 'name-za': filteredApps.sort((a, b) => b.name.localeCompare(a.name)); break;
        }
        const gridContainer = getEl('latestList');
        gridContainer.innerHTML = filteredApps.length > 0 ? filteredApps.map(app => createAppCardHTML(app)).join('') : `<div class="not-found-container"><h3 data-translate-key="notFoundTitle">No Results Found</h3></div>`;
    }
    
    function isNew(app) {
        return app.addedTimestamp && (Date.now() - app.addedTimestamp) < NEW_DURATION_MS;
    }

    function createAppCardHTML(app) {
        const newTagHTML = isNew(app) ? '<div class="new-tag">NEW</div>' : '';
        return `
            <div class="item-card" data-app-id="${app.id}">
                ${newTagHTML}
                <div class="item-card-icon-container">
                    <img src="${escapeHTML(app.img)}" class="item-card-icon" alt="${escapeHTML(app.name)} icon" onerror="this.src='https://i.ibb.co/MyjL8DZk/IMG-20250502-151238-214.jpg'">
                </div>
                <div class="item-card-title">${escapeHTML(app.name)}</div>
                <div class="item-card-info">
                    <span>v${app.version}</span>
                    <span>${app.size}</span>
                </div>
            </div>`;
    }

    function showItemDetail(app) {
        currentDetailApp = app;
        getEl('mainContentWrapper').classList.add('hidden');
        const detailSection = getEl('sectionDetail');
        detailSection.classList.remove('hidden', 'active');
        void detailSection.offsetWidth;
        detailSection.classList.add('active');
        window.scrollTo(0, 0);

        getEl('detailAppImage').src = escapeHTML(app.img);
        getEl('detailAppName').textContent = escapeHTML(app.name);
        getEl('detailAppInfo').textContent = `Version: ${app.version} | Size: ${app.size}`;
        getEl('detailAppDownloadLink').href = escapeHTML(app.link);
        const playStoreLinkEl = getEl('detailAppPlayStoreLink');
        if (app.playStoreLink && app.playStoreLink.trim() !== '') {
            playStoreLinkEl.href = escapeHTML(app.playStoreLink);
            playStoreLinkEl.classList.remove('hidden');
        } else {
            playStoreLinkEl.classList.add('hidden');
        }

        const screenshotSection = getEl("screenshotSection");
        const screenshotGallery = getEl("screenshotGallery");
        screenshotGallery.innerHTML = '';
        if (app.screenshots && Array.isArray(app.screenshots) && app.screenshots.length > 0) {
            screenshotSection.classList.remove('hidden');
            app.screenshots.forEach((ssUrl, index) => {
                const img = document.createElement('img');
                img.src = escapeHTML(ssUrl);
                img.className = 'screenshot-img';
                img.onclick = () => showLightbox(index);
                screenshotGallery.appendChild(img);
            });
        } else { screenshotSection.classList.add('hidden'); }

        const descContainer = getEl("detailAppDescContainer").querySelector('ul');
        descContainer.innerHTML = '';
        if (app.description && Array.isArray(app.description) && app.description.filter(d => d.trim()).length > 0) {
            app.description.forEach(featureText => {
                if(featureText.trim()){
                    const li = document.createElement('li');
                    li.innerHTML = `<span class="material-icons">check_circle</span><span>${escapeHTML(featureText)}</span>`;
                    descContainer.appendChild(li);
                }
            });
        } else { descContainer.innerHTML = `<li>No detailed description available.</li>`; }
    }

    function hideDetailSection() {
        getEl('mainContentWrapper').classList.remove('hidden');
        const detailSection = getEl('sectionDetail');
        detailSection.classList.remove('active');
        detailSection.classList.add('hidden');
    }

    function showLightbox(index) {
        if (!currentDetailApp || !currentDetailApp.screenshots) return;
        currentScreenshotIndex = index;
        getEl('lightboxOverlay').classList.add('active');
        updateLightboxImage();
    }
    
    function hideLightbox() { getEl('lightboxOverlay').classList.remove('active'); }
    function showNextScreenshot() { currentScreenshotIndex = (currentScreenshotIndex + 1) % currentDetailApp.screenshots.length; updateLightboxImage(); }
    function showPrevScreenshot() { const total = currentDetailApp.screenshots.length; currentScreenshotIndex = (currentScreenshotIndex - 1 + total) % total; updateLightboxImage(); }
    function updateLightboxImage() { if (!currentDetailApp || !currentDetailApp.screenshots) return; getEl('lightboxImage').src = escapeHTML(currentDetailApp.screenshots[currentScreenshotIndex]); }

    function setupEventListeners() {
        document.body.addEventListener('click', function(e) {
            const card = e.target.closest('.item-card, .hot-card-item');
            if (card && card.dataset.appId) {
                const app = allAppsData.find(a => a.id === parseInt(card.dataset.appId));
                if (app) showItemDetail(app);
            }
        });
        queryEl('#sectionDetail .btn-back').addEventListener('click', hideDetailSection);
        getEl('lightboxClose').addEventListener('click', hideLightbox);
        getEl('lightboxNext').addEventListener('click', showNextScreenshot);
        getEl('lightboxPrev').addEventListener('click', showPrevScreenshot);
        getEl('lightboxOverlay').addEventListener('click', (e) => { if (e.target.id === 'lightboxOverlay') hideLightbox(); });

        queryEl('.search').addEventListener('input', () => { clearTimeout(searchDebounceTimeout); searchDebounceTimeout = setTimeout(handleFilterOrSearch, 300); });
        queryEl('.search-icon').addEventListener('click', (e) => { 
            e.stopPropagation(); 
            const header = queryEl('header'); 
            const searchInput = queryEl('.search');
            const isActive = header.classList.toggle('search-active');
            if(isActive) searchInput.focus();
            else if(searchInput.value) { searchInput.value = ''; handleFilterOrSearch(); }
        });

        getEl('floating-settings-btn').addEventListener('click', () => { getEl('settings-modal').classList.add('open'); getEl('floating-settings-btn').classList.add('rotate'); });
        getEl('close-settings-btn').addEventListener('click', () => { getEl('settings-modal').classList.remove('open'); getEl('floating-settings-btn').classList.remove('rotate'); });
        
        getEl('theme-toggle').addEventListener('change', (e) => { document.body.classList.toggle('light-mode', e.target.checked); localStorage.setItem('theme', e.target.checked ? 'light' : 'dark'); });
        getEl('language-select').addEventListener('change', (e) => { const lang = e.target.value; localStorage.setItem('language', lang); updateAllUIText(lang); generateCategoryButtons(); });
        getEl('items-per-page-select').addEventListener('change', (e) => localStorage.setItem('itemsPerPage', e.target.value));
        getEl('infinite-scroll-toggle').addEventListener('change', (e) => localStorage.setItem('infiniteScroll', e.target.checked));
        getEl('category-filter-buttons').addEventListener('click', (e) => {
            const button = e.target.closest('button');
            if(button){
                queryEl('#category-filter-buttons button.active')?.classList.remove('active');
                button.classList.add('active');
                localStorage.setItem('category', button.dataset.category);
                handleFilterOrSearch();
            }
        });
        
        getEl('clear-filters-btn').addEventListener('click', () => {
            localStorage.setItem('category', 'all');
            queryEl('.search').value = '';
            queryEl('#category-filter-buttons button.active')?.classList.remove('active');
            queryEl('#category-filter-buttons button[data-category="all"]')?.classList.add('active');
            handleFilterOrSearch();
            getEl('settings-modal').classList.remove('open');
        });
        getEl('sort-select').addEventListener('change', handleFilterOrSearch);
        getEl('reset-settings-btn').addEventListener('click', () => { if(confirm('Are you sure?')){ localStorage.clear(); window.location.reload(); } });
        getEl('changelog-btn').addEventListener('click', showChangelog);
        getEl('contact-owner-btn').addEventListener('click', () => { getEl('settings-modal').classList.remove('open'); getEl('popup-form').style.display = 'flex'; });
        getEl('send-to-owner-btn').addEventListener('click', sendToTelegram);
    }

    function generateCategoryButtons() {
        const categories = ['all', ...new Set(allAppsData.map(app => app.category || 'Other').sort())];
        const container = getEl('category-filter-buttons');
        const currentCategory = localStorage.getItem('category') || 'all';
        container.innerHTML = categories.map(cat => `<button data-category="${cat}" class="${cat.toLowerCase() === currentCategory.toLowerCase() ? 'active' : ''}"><span>${escapeHTML(cat === 'all' ? (translations[currentLanguage]?.categoryAll || 'All') : cat)}</span></button>`).join('');
    }

    function updateAllUIText(lang) {
        currentLanguage = lang;
        document.documentElement.lang = lang;
        document.body.dir = ['ar', 'ur', 'fa'].includes(lang) ? 'rtl' : 'ltr';
        queryAll('[data-translate-key]').forEach(el => {
            const key = el.dataset.translateKey;
            const translation = translations[lang]?.[key] || translations['en'][key];
            if (translation) { el[el.placeholder ? 'placeholder' : 'innerHTML'] = translation; }
        });
    }

    function showChangelog() {
        const popup = getEl('popup');
        const content = getEl('popup-content');
        content.innerHTML = `<h2 data-translate-key="changelogTitle">${translations[currentLanguage]?.changelogTitle || 'Changelog'}</h2><div class="changelog-content"><h3>Version 4.2</h3><ul><li>Added 'Hot Apps' section for featured apps.</li><li>Prettified settings panel text with icons.</li><li>All settings are fully functional.</li></ul></div>`;
        popup.style.display = 'flex';
        popup.onclick = (e) => { if(e.target.id === 'popup') popup.style.display = 'none'; };
    }

    function sendToTelegram() {
        const name = getEl('userName').value.trim();
        const problem = getEl('userProblem').value.trim();
        if (!name || !problem) return alert('Please fill all fields.');
        const message = `Problem Report:\nName: ${name}\nProblem: ${problem}`;
        const botToken = "8155167031:AAEDdDkoKfSQNBIJ9PyBj3ARSqV7Ab5tbTA";
        const chatId = "7155853255";
        getEl('send-to-owner-btn').disabled = true;
        fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ chat_id: chatId, text: message })
        }).then(res => res.json()).then(data => {
            if (data.ok) { alert('Message sent!'); getEl('popup-form').style.display = 'none'; getEl('userName').value = ''; getEl('userProblem').value = ''; }
            else { throw new Error('Failed to send.'); }
        }).catch(err => alert('Error sending message.')).finally(() => getEl('send-to-owner-btn').disabled = false);
    }
    
    const escapeHTML = (str) => str ? String(str).replace(/[&<>"']/g, match => ({'&': '&amp;','<': '&lt;','>': '&gt;','"': '&quot;',"'": '&#39;'})[match]) : '';
    
    function startFloatingHearts() {
        const container = getEl('hearts-container');
        if (container) {
            setInterval(() => {
                const heartEl = document.createElement('div');
                heartEl.classList.add('heart');
                heartEl.innerHTML = `<svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>`;
                heartEl.style.setProperty('--size', `${Math.random() * 30 + 15}px`);
                heartEl.style.left = `${Math.random() * 100}%`;
                heartEl.style.animationDuration = `${Math.random() * 6 + 7}s`;
                container.appendChild(heartEl);
                setTimeout(() => heartEl.remove(), 13000);
            }, 600);
        }
    }

    function setupSettingsAnimation() {
        if ('IntersectionObserver' in window) {
            settingsObserver = new IntersectionObserver((entries) => { entries.forEach(entry => { entry.target.classList.toggle('is-visible', entry.isIntersecting); }); }, { root: getEl('settings-modal'), threshold: 0.1 });
            queryAll('#settings-modal .setting-option').forEach(option => settingsObserver.observe(option));
        }
    }

    function setupScrollAnimations() {
        if (!('IntersectionObserver' in window)) return;
        const observerOptions = { root: null, rootMargin: '0px', threshold: 0.01 };
        const intersectionObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                entry.target.classList.toggle('is-visible', entry.isIntersecting);
            });
        }, observerOptions);
        const mainWrapper = getEl('mainContentWrapper');
        if (!mainWrapper) return;
        const mutationObserver = new MutationObserver((mutationsList) => {
            for (const mutation of mutationsList) {
                if (mutation.type === 'childList') {
                    mutation.addedNodes.forEach(node => {
                        if (node.nodeType === 1) { 
                            node.querySelectorAll('.item-card, .hot-card-item').forEach(card => intersectionObserver.observe(card));
                            if (node.matches('.item-card, .hot-card-item')) intersectionObserver.observe(node);
                        }
                    });
                }
            }
        });
        mutationObserver.observe(mainWrapper, { childList: true, subtree: true });
        queryAll('.item-card, .hot-card-item').forEach(card => intersectionObserver.observe(card));
    }
</script>

</body>
</html>